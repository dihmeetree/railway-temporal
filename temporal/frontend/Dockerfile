FROM temporalio/auto-setup:1.22.2

ARG DB DBNAME DB_PORT POSTGRES_USER POSTGRES_PWD POSTGRES_SEEDS

COPY ./dynamic.yaml /etc/temporal/config/dynamicconfig/dynamic.yaml

ENV BIND_ON_IP="0.0.0.0"
ENV DB="postgresql"
ENV DB_PORT=5432
ENV DYNAMIC_CONFIG_FILE_PATH="config/dynamicconfig/dynamic.yaml"
ENV ENABLE_ALPINE_PRIVATE_NETWORKING=true
ENV ENABLE_ES=true
ENV ES_PORT=9200
ENV ES_SCHEME="http"
ENV ES_VERSION="v7"
ENV FRONTEND_GRPC_PORT=7237
ENV PROMETHEUS_ENDPOINT="0.0.0.0:8002"
ENV SERVICES="frontend"
ENV TEMPORAL_BROADCAST_ADDRESS="127.0.0.1"
ENV TEMPORAL_HISTORY_NAMESPACEDEFAULT_ARCHIVAL_FILESTORE="enabled"
ENV TEMPORAL_VISIBILITY_NAMESPACEDEFAULT_ARCHIVAL_FILESTORE="enabled"